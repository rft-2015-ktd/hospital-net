<ui:composition template="/templates/masterLayout.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:sec="http://www.springframework.org/security/tags">
	<ui:define name="head-extra">
		<!-- custom css -->
	</ui:define>
	<ui:define name="pageTitle">Betegfelvétel</ui:define>
	<ui:define name="content">

		<p:panel header="Betegkezelés">
			<p:dataTable var="patient" value="#{patientreg.lazyModel}"
				paginator="true" rows="5"
				paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
				rowsPerPageTemplate="5,10,15" selectionMode="single"
				id="patientTable" lazy="true">

				<p:ajax event="rowSelect" listener="#{patientreg.onRowSelect}"
					update="UpdatepatientDialog,update,dismiss" />

				<p:column headerText="Name">
					<h:outputText value="#{patient.name}" />
				</p:column>

				<p:column headerText="Ssn">
					<h:outputText value="#{patient.ssn}" />
				</p:column>

				<p:column headerText="IdNumber">
					<h:outputText value="#{patient.idNumber}" />
				</p:column>

				<p:column headerText="DOB">
					<h:outputText value="#{patient.dateOfBirth}" />
				</p:column>

				<p:column headerText="Diag">
					<h:outputText value="#{patient.diagnostic}" escape="false" />
				</p:column>
				
					<p:column headerText="Status">
					<h:outputText value="#{patient.status}" />
				</p:column>
			</p:dataTable>

			<p:commandButton id="new" value="Új beteg" title="Save" type="button"
				onclick="PF('create').show()">
			</p:commandButton>

			<p:commandButton id="update" value="Beteg frissitése" title="Update"
				type="button" onclick="PF('update').show()"
				disabled="#{patientreg.selectedPatient == null}">
			</p:commandButton>

			<p:commandButton value="Beteg elbocsájtás" id="dismiss" update="growl"
				actionListener="#{patientreg.dismiss}"
				disabled="#{patientreg.selectedPatient == null}"
				 />


			<p:dialog id="CreatepatientDialog" widgetVar="create" modal="true"
				showEffect="fade" hideEffect="fade" resizable="false" header="">
				<h:form id="dialogFormCreate">

					<p:outputPanel id="whDetail" style="text-align:left;">
						<p:panelGrid columns="2" columnClasses="label,value">

							<h:outputText value="Név" />
							<p:inputText id="nameInput" required="true"
								value="#{patientreg.name}" />

							<h:outputText value="SSN" />
							<p:inputText id="ssn" required="true" value="#{patientreg.ssn}" />

							<h:outputText value="idNumber" />
							<p:inputText id="idNumber" required="true"
								value="#{patientreg.idNumber}" />

							<h:outputText value="dateOfBorth" />
							<p:calendar id="mask" value="#{patientreg.dateOfBirth}"
								pattern="dd-MM-yyyy" mask="true" />

							<h:outputText value="diag" />
							<p:editor id="editor" widgetVar="editorWidget"
								value="#{patientreg.diagnostic}" />

						</p:panelGrid>
						<div align="center" style="margin-top: 10px;">
							<p:commandButton id="savePatient" value="Mentés"
								action="#{patientreg.save()}" icon="ui-icon-check"
								update="CreatepatientDialog" oncomplete="PF('create').hide();" />
						</div>
					</p:outputPanel>
				</h:form>
			</p:dialog>

			<p:dialog id="UpdatepatientDialog" widgetVar="update" modal="true"
				showEffect="fade" hideEffect="fade" resizable="false" header="">
				<h:form id="dialogFormUpdate">

					<p:outputPanel id="whDetail" style="text-align:left;">
						<p:panelGrid columns="2" columnClasses="label,value">

							<h:outputText value="Név" />
							<p:inputText id="nameInput" required="true"
								value="#{patientreg.upname}" />

							<h:outputText value="SSN" />
							<p:inputText id="ssn" required="true" value="#{patientreg.upssn}" />

							<h:outputText value="idNumber" />
							<p:inputText id="idNumber" required="true"
								value="#{patientreg.upidNumber}" />

							<h:outputText value="dateOfBorth" />
							<p:calendar id="mask" value="#{patientreg.updateOfBirth}"
								pattern="dd-MM-yyyy" mask="true" />

							<h:outputText value="diag" />
							<p:editor id="editor" widgetVar="editorWidget"
								value="#{patientreg.updiagnostic}" />

						</p:panelGrid>
						<div align="center" style="margin-top: 10px;">
							<p:commandButton id="updatePatient" value="Frissités"
								action="#{patientreg.update()}" icon="ui-icon-check"
								update="UpdatepatientDialog" oncomplete="PF('update').hide();" />
						</div>
					</p:outputPanel>
				</h:form>
			</p:dialog>


		</p:panel>

	</ui:define>
</ui:composition>